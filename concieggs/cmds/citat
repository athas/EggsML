#!/bin/sh
#
# Et godt citat fra en kendt person til at cementere en holdning eller
# sprede inspiration.
#
# Brug: citat [--ai]
#       citat - henter et tilfældigt citat fra databasen
#       citat --ai - bruger ChatGPT til at generere et passende citat

begrundelser() {
    echo "Dette citat vil uden tvivl bringe klarhed til debatten."
    echo "Som ordene fra denne vise person viser, er der intet mere at diskutere."
    echo "Dette citat rammer hovedet på sømmet og løser alle problemer."
    echo "Med disse ord i baghovedet kan vi alle blive enige."
    echo "Lad os alle reflektere over denne dybsindige visdom."
    echo "Disse ord vil helt sikkert inspirere og oplyse."
    echo "Dette er præcis hvad situationen kalder på."
    echo "Her har vi nøglen til at forstå hele problematikken."
    echo "Med denne indsigt er vejen frem nu krystalklar."
    echo "Dette citat bør læres udenad af enhver tænkende person."
    echo "Præcis sådan bør alle tænkende mennesker forholde sig til verden."
    echo "Denne indsigt ændrer alt."
    echo "Efter at have hørt dette, kan ingen være i tvivl."
    echo "Visdom som denne findes sjældent."
    echo "Dette burde skrives i guld på alle rådhuse."
}

if [ "$1" = "--ai" ]; then
    # Brug ChatGPT til at generere et citat
    prompt="Giv mig et dansk citat fra en kendt historisk person eller filosof. Formatet skal være: 'citattekst|personnavn'. Citatet skal være på dansk og kan være opdigtet men realistisk. Kun output citatet, intet andet."
    ai_citat=$(gpt4o 100 "$prompt")
    
    # Hvis AI-responset er tomt eller fejler, fall tilbage til database
    if [ -z "$ai_citat" ] || ! echo "$ai_citat" | grep -q '|'; then
        citat_og_person=$(cat "$CONCIEGGS_DB_DIR/citater" | randomLine)
    else
        citat_og_person="$ai_citat"
    fi
else
    # Hent fra databasen
    citat_og_person=$(cat "$CONCIEGGS_DB_DIR/citater" | randomLine)
fi

citat=$(echo "$citat_og_person" | cut -d'|' -f1)
person=$(echo "$citat_og_person" | cut -d'|' -f2)
begrundelse=$(begrundelser | randomLine)

echo "$EGGS_USER: \"$citat\" - $person"
echo "$EGGS_USER: $begrundelse"
